import{r as w,aD as T,R as $,j as d,_ as N,P as U}from"./index-4cb06891.js";import{C as q}from"./ContentSection-cd16a23d.js";const I=t=>{let r;const o=new Set,n=(m,a)=>{const v=typeof m=="function"?m(r):m;if(!Object.is(v,r)){const f=r;r=a??(typeof v!="object"||v===null)?v:Object.assign({},r,v),o.forEach(h=>h(r,f))}},i=()=>r,p={setState:n,getState:i,getInitialState:()=>E,subscribe:m=>(o.add(m),()=>o.delete(m)),destroy:()=>{o.clear()}},E=r=t(n,i,p);return p},W=t=>t?I(t):I;var B={exports:{}},M={},A={exports:{}},L={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var P=w;function H(t,r){return t===r&&(t!==0||1/t===1/r)||t!==t&&r!==r}var Q=typeof Object.is=="function"?Object.is:H,J=P.useState,K=P.useEffect,X=P.useLayoutEffect,Y=P.useDebugValue;function Z(t,r){var o=r(),n=J({inst:{value:o,getSnapshot:r}}),i=n[0].inst,l=n[1];return X(function(){i.value=o,i.getSnapshot=r,C(i)&&l({inst:i})},[t,o,r]),K(function(){return C(i)&&l({inst:i}),t(function(){C(i)&&l({inst:i})})},[t]),Y(o),o}function C(t){var r=t.getSnapshot;t=t.value;try{var o=r();return!Q(t,o)}catch{return!0}}function ee(t,r){return r()}var te=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?ee:Z;L.useSyncExternalStore=P.useSyncExternalStore!==void 0?P.useSyncExternalStore:te;A.exports=L;var re=A.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var G=w,ne=re;function ae(t,r){return t===r&&(t!==0||1/t===1/r)||t!==t&&r!==r}var se=typeof Object.is=="function"?Object.is:ae,oe=ne.useSyncExternalStore,ce=G.useRef,ie=G.useEffect,ue=G.useMemo,le=G.useDebugValue;M.useSyncExternalStoreWithSelector=function(t,r,o,n,i){var l=ce(null);if(l.current===null){var c={hasValue:!1,value:null};l.current=c}else c=l.current;l=ue(function(){function p(f){if(!E){if(E=!0,m=f,f=n(f),i!==void 0&&c.hasValue){var h=c.value;if(i(h,f))return a=h}return a=f}if(h=a,se(m,f))return h;var b=n(f);return i!==void 0&&i(h,b)?(m=f,h):(m=f,a=b)}var E=!1,m,a,v=o===void 0?null:o;return[function(){return p(r())},v===null?void 0:function(){return p(v())}]},[r,o,n,i]);var g=oe(t,l[0],l[1]);return ie(function(){c.hasValue=!0,c.value=g},[g]),le(g),g};B.exports=M;var de=B.exports;const fe=T(de),{useDebugValue:he}=$,{useSyncExternalStoreWithSelector:me}=fe;const Se=t=>t;function pe(t,r=Se,o){const n=me(t.subscribe,t.getState,t.getServerState||t.getInitialState,r,o);return he(n),n}const O=t=>{const r=typeof t=="function"?W(t):t,o=(n,i)=>pe(r,n,i);return Object.assign(o,r),o},ve=t=>t?O(t):O,R=ve(t=>({score:0,highScore:0,isPaused:!1,isRunning:!1,setScore:r=>t({score:r}),addScore:r=>t(o=>({score:o.score+r})),setHighScore:r=>t({highScore:r}),setPaused:r=>t({isPaused:r}),setRunning:r=>t({isRunning:r})})),ge=({width:t="100%",height:r="100%"})=>{const o=w.useRef(null),n=w.useRef(null);return w.useEffect(()=>{let i=!0,l=null,c=null;try{typeof window<"u"&&window.__PHASER_DEBUG__&&(window.getPhaserGame=()=>({scene:{getScene:()=>{},getScenes:()=>[]}}),console.debug("[PhaserCanvas] safe window.getPhaserGame attached (no game yet)"))}catch{}(async()=>{try{const[e,s]=await Promise.all([N(()=>import("./SnakeScene-fd34a1e8.js"),["./SnakeScene-fd34a1e8.js","./index-4cb06891.js","./index-d3ca682a.css","./ContentSection-cd16a23d.js"],import.meta.url),N(()=>import("./phaser-eccebaae.js").then(S=>S.p),["./phaser-eccebaae.js","./index-4cb06891.js","./index-d3ca682a.css"],import.meta.url)]),u=e&&e.default?e.default:null;if(c=s&&s.default?s.default:s,!u||!c){console.error("[PhaserCanvas] Failed to dynamically import Phaser or SnakeScene");return}if(l=u(c),console.debug("[PhaserCanvas] loadPhaser: imports done",{hasScene:!!l,hasPhaser:!!c}),i){const S=m();console.debug("[PhaserCanvas] loadPhaser: createIfReady returned",{created:S,hasGame:!!n.current})}}catch(e){console.error("[PhaserCanvas] dynamic import failed",e)}})();const p=()=>{var u;const e=((u=o.current)==null?void 0:u.getBoundingClientRect())||{width:600,height:600},s=Math.min(window.devicePixelRatio||1,2);return{width:Math.round(e.width*s),height:Math.round(e.height*s)}};p();const E=(e,s)=>({type:c&&c.AUTO||0,parent:o.current,backgroundColor:"#000000",scale:{mode:c&&c.Scale?c.Scale.FIT:void 0,autoCenter:c&&c.Scale?c.Scale.CENTER_BOTH:void 0,width:e,height:s},scene:[l],physics:{default:"arcade"}}),m=()=>{try{if(!o.current)return!1;const{width:e,height:s}=o.current.getBoundingClientRect(),u=Math.min(window.devicePixelRatio||1,2),S=Math.round(Math.max(1,e)*u),y=Math.round(Math.max(1,s)*u);if(S<=1||y<=1)return!1;if(!n.current&&l&&c)try{console.debug("[PhaserCanvas] createIfReady: creating Phaser.Game",{rw:S,rh:y,hasPhaser:!!c,hasScene:!!l,PhaserGameCtor:!!c&&!!c.Game}),n.current=new c.Game({...E(S,y),scene:[l]}),n.current&&n.current.canvas&&n.current.canvas.setAttribute("data-testid","phaser-canvas"),console.debug("[PhaserCanvas] Game created with",S,y)}catch(F){console.error("[PhaserCanvas] Failed to create Phaser.Game",F,{rw:S,rh:y,hasPhaser:!!c,hasScene:!!l})}return!!n.current}catch(e){return console.error("[PhaserCanvas] Failed to create Phaser.Game",e),!1}};if(i&&(!m()||!n.current)){const s=setInterval(()=>{m()&&n.current&&clearInterval(s)},50)}try{console.debug("[PhaserCanvas] Game created",!!n.current)}catch{}try{if(typeof window<"u"&&window.__PHASER_DEBUG__){try{window.getPhaserGame=()=>n.current}catch{}try{console.debug("[PhaserCanvas] window.getPhaserGame attached")}catch{}if(o.current){try{o.current.getPhaserGame=()=>n.current||{scene:{getScene:()=>{},getScenes:()=>[]}}}catch{}try{console.debug("[PhaserCanvas] container.getPhaserGame attached")}catch{}}}}catch{}let a=null,v=0;const f=[],h=[],b=[],_=e=>{if(!e||!e.events)return!1;e.events.on("update",s=>{R.getState().setScore(s.score||0)}),e.events.on("gameOver",s=>{R.getState().setRunning(!1)}),e.events.on("ateFood",s=>{R.getState().setScore(s)});try{const s=u=>{e&&typeof e.processSimulatedSwipe=="function"&&e.processSimulatedSwipe(u.detail)};if(typeof window<"u"){window.addEventListener("snake-simulate-swipe",s);try{console.debug("[PhaserCanvas] attached snake-simulate-swipe listener")}catch{}}e.__onSimSwipe=s}catch(s){try{console.error("[PhaserCanvas] failed to attach onSimSwipe",s)}catch{}}return!0};if(!a||!a.events){const e=setInterval(()=>{if(v++,n.current&&n.current.scene&&(a=n.current.scene.getScene("SnakeScene")||n.current.scene.getScenes&&n.current.scene.getScenes()[0]),(_(a)||v>20)&&(clearInterval(e),a)){try{console.debug("[PhaserCanvas] Processing queued events",f.length,h.length)}catch{}f.forEach(s=>{const{action:u,value:S}=s||{};u==="start"&&a.startGame(),u==="pause"&&a.pauseGame(),u==="resume"&&a.resumeGame(),u==="reset"&&a.resetGame(),u==="stop"&&a.stopGame(),u==="setBoardSize"&&a.setBoardSize(Number(S))}),h.forEach(s=>a.setDirection(s)),b.forEach(s=>{s&&typeof a.processSimulatedSwipe=="function"&&a.processSimulatedSwipe(s)}),b.length=0,f.length=0,h.length=0}},50)}else{_(a);try{console.debug("[PhaserCanvas] Scene immediately available, processing queued events",f.length,h.length)}catch{}f.forEach(e=>{const{action:s,value:u}=e||{};s==="start"&&a.startGame(),s==="pause"&&a.pauseGame(),s==="resume"&&a.resumeGame(),s==="reset"&&a.resetGame(),s==="stop"&&a.stopGame(),s==="setBoardSize"&&a.setBoardSize(Number(u))}),h.forEach(e=>a.setDirection(e)),b.forEach(e=>{e&&typeof a.processSimulatedSwipe=="function"&&a.processSimulatedSwipe(e)}),b.length=0,f.length=0,h.length=0}const j=e=>{if(a&&typeof a.setDirection=="function")a.setDirection(e.detail);else{try{console.debug("[PhaserCanvas] Queuing direction event",e.detail)}catch{}h.push(e.detail)}};window.addEventListener("snake-direction",j);const k=e=>{a&&typeof a.processSimulatedSwipe=="function"?a.processSimulatedSwipe(e.detail):b.push(e.detail)};window.addEventListener("snake-simulate-swipe",k);const D=e=>{const{action:s,value:u}=e.detail||{};if(!a){try{console.debug("[PhaserCanvas] Queuing control event",e.detail)}catch{}f.push(e.detail);return}switch(s){case"start":a.startGame();break;case"pause":a.pauseGame();break;case"resume":a.resumeGame();break;case"reset":a.resetGame();break;case"stop":a.stopGame();break;case"setBoardSize":a.setBoardSize(Number(u));break}};window.addEventListener("snake-control",D);const V=()=>{var u,S,y;if(!n.current||!o.current)return;const{width:e,height:s}=p();(u=n.current)!=null&&u.scale&&n.current.scale.resize(e,s),(y=(S=n.current)==null?void 0:S.events)==null||y.emit("resize",{width:e,height:s})},z=new ResizeObserver(V);return o.current&&z.observe(o.current),()=>{if(i=!1,n.current){try{n.current.destroy(!0)}catch{}n.current=null}window.removeEventListener("snake-direction",j),window.removeEventListener("snake-simulate-swipe",k);try{if(n.current&&n.current.scene){const e=n.current.scene.getScene("SnakeScene")||n.current.scene.getScenes&&n.current.scene.getScenes()[0];e&&e.__onSimSwipe&&(window.removeEventListener("snake-simulate-swipe",e.__onSimSwipe),delete e.__onSimSwipe)}}catch{}window.removeEventListener("snake-control",D),z.disconnect();try{o.current&&o.current.getPhaserGame&&delete o.current.getPhaserGame}catch{}try{window&&window.getPhaserGame&&delete window.getPhaserGame}catch{}}},[]),d.jsx("div",{ref:o,style:{width:t,height:r},className:"phaser-container"})},we=ge,x=(t,r)=>{if(!(typeof window>"u"))try{window.dispatchEvent(new CustomEvent("snake-control",{detail:{action:t,value:r}}))}catch{}};function be(){const[t,r]=w.useState(!1),[o,n]=w.useState(20),i=()=>{x("start"),r(!0)},l=()=>{x("pause"),r(!1)},c=()=>{x("reset"),r(!1)},g=p=>{n(p),x("setBoardSize",p)};return w.useEffect(()=>{i()},[]),w.useEffect(()=>()=>{x("stop")},[]),d.jsxs("main",{className:"max-w-4xl mx-auto px-4 py-12",children:[d.jsx(U,{title:"Snake",description:"A small, mobile-friendly Snake game built with Phaser."}),d.jsx(q,{title:"Snake Game",children:d.jsx("p",{className:"text-gray-300",children:"Play a short, focus-friendly Snake game. Use on-screen controls or your keyboard."})}),d.jsx("section",{className:"py-6",children:d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[d.jsx("div",{className:"bg-[#0b1220] p-6 rounded-xl border border-white/6",children:d.jsxs("div",{className:"flex flex-col gap-3",children:[d.jsx("div",{className:"text-gray-300",children:"Board Size"}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("button",{className:"btn",onClick:()=>g(16),children:"Small"}),d.jsx("button",{className:"btn",onClick:()=>g(20),children:"Medium"}),d.jsx("button",{className:"btn",onClick:()=>g(28),children:"Large"})]}),d.jsxs("div",{className:"flex gap-2 mt-4",children:[t?d.jsx("button",{className:"btn",onClick:l,children:"Pause"}):d.jsx("button",{className:"btn btn-primary",onClick:i,children:"Start"}),d.jsx("button",{className:"btn",onClick:c,children:"Reset"})]})]})}),d.jsx("div",{className:"lg:col-span-2 bg-[#0b1220] p-6 rounded-xl border border-white/6",children:d.jsx("div",{className:"h-[480px]",children:d.jsx(we,{width:"100%",height:"100%"})})})]})})]})}const Pe=Object.freeze(Object.defineProperty({__proto__:null,default:be},Symbol.toStringTag,{value:"Module"}));export{Pe as S,R as u};
