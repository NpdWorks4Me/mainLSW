import{r as E,aD as V,R as T,j as l,_ as k,P as $}from"./index-fe913258.js";import{C as F}from"./ContentSection-37b465dd.js";const D=t=>{let n;const s=new Set,r=(m,b)=>{const v=typeof m=="function"?m(n):m;if(!Object.is(v,n)){const e=n;n=b??(typeof v!="object"||v===null)?v:Object.assign({},n,v),s.forEach(o=>o(n,e))}},i=()=>n,w={setState:r,getState:i,getInitialState:()=>y,subscribe:m=>(s.add(m),()=>s.delete(m)),destroy:()=>{s.clear()}},y=n=t(r,i,w);return w},q=t=>t?D(t):D;var N={exports:{}},O={},I={exports:{}},L={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var P=E;function U(t,n){return t===n&&(t!==0||1/t===1/n)||t!==t&&n!==n}var W=typeof Object.is=="function"?Object.is:U,H=P.useState,Q=P.useEffect,J=P.useLayoutEffect,K=P.useDebugValue;function X(t,n){var s=n(),r=H({inst:{value:s,getSnapshot:n}}),i=r[0].inst,d=r[1];return J(function(){i.value=s,i.getSnapshot=n,G(i)&&d({inst:i})},[t,s,n]),Q(function(){return G(i)&&d({inst:i}),t(function(){G(i)&&d({inst:i})})},[t]),K(s),s}function G(t){var n=t.getSnapshot;t=t.value;try{var s=n();return!W(t,s)}catch{return!0}}function Y(t,n){return n()}var Z=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Y:X;L.useSyncExternalStore=P.useSyncExternalStore!==void 0?P.useSyncExternalStore:Z;I.exports=L;var ee=I.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var R=E,te=ee;function ne(t,n){return t===n&&(t!==0||1/t===1/n)||t!==t&&n!==n}var re=typeof Object.is=="function"?Object.is:ne,se=te.useSyncExternalStore,ae=R.useRef,oe=R.useEffect,ce=R.useMemo,ie=R.useDebugValue;O.useSyncExternalStoreWithSelector=function(t,n,s,r,i){var d=ae(null);if(d.current===null){var g={hasValue:!1,value:null};d.current=g}else g=d.current;d=ce(function(){function w(e){if(!y){if(y=!0,m=e,e=r(e),i!==void 0&&g.hasValue){var o=g.value;if(i(o,e))return b=o}return b=e}if(o=b,re(m,e))return o;var u=r(e);return i!==void 0&&i(o,u)?(m=e,o):(m=e,b=u)}var y=!1,m,b,v=s===void 0?null:s;return[function(){return w(n())},v===null?void 0:function(){return w(v())}]},[n,s,r,i]);var p=se(t,d[0],d[1]);return oe(function(){g.hasValue=!0,g.value=p},[p]),ie(p),p};N.exports=O;var ue=N.exports;const le=V(ue),{useDebugValue:de}=T,{useSyncExternalStoreWithSelector:fe}=le;const he=t=>t;function me(t,n=he,s){const r=fe(t.subscribe,t.getState,t.getServerState||t.getInitialState,n,s);return de(r),r}const z=t=>{const n=typeof t=="function"?q(t):t,s=(r,i)=>me(n,r,i);return Object.assign(s,n),s},Se=t=>t?z(t):z,_=Se(t=>({score:0,highScore:0,isPaused:!1,isRunning:!1,setScore:n=>t({score:n}),addScore:n=>t(s=>({score:s.score+n})),setHighScore:n=>t({highScore:n}),setPaused:n=>t({isPaused:n}),setRunning:n=>t({isRunning:n})})),pe=({width:t="100%",height:n="100%"})=>{const s=E.useRef(null),r=E.useRef(null);return E.useEffect(()=>{let i=!0,d=null;(async()=>{try{const[e,o]=await Promise.all([k(()=>import("./SnakeScene-b0b6ae3a.js"),["assets/SnakeScene-b0b6ae3a.js","assets/index-fe913258.js","assets/index-e280a725.css","assets/ContentSection-37b465dd.js"]),k(()=>import("./phaser-1ccbccd0.js").then(S=>S.p),["assets/phaser-1ccbccd0.js","assets/index-fe913258.js","assets/index-e280a725.css"])]),u=e&&e.default?e.default:null,f=o&&o.default?o.default:o;if(!u||!f){console.error("[PhaserCanvas] Failed to dynamically import Phaser or SnakeScene");return}d=u(f),i&&y()}catch(e){console.error("[PhaserCanvas] dynamic import failed",e)}})();const p=()=>{var u;const e=((u=s.current)==null?void 0:u.getBoundingClientRect())||{width:600,height:600},o=Math.min(window.devicePixelRatio||1,2);return{width:Math.round(e.width*o),height:Math.round(e.height*o)}};p();const w=(e,o)=>({type:Phaser.AUTO,parent:s.current,backgroundColor:"#000000",scale:{mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH,width:e,height:o},scene:[d],physics:{default:"arcade"}}),y=()=>{try{if(!s.current)return!1;const{width:e,height:o}=s.current.getBoundingClientRect(),u=Math.min(window.devicePixelRatio||1,2),f=Math.round(Math.max(1,e)*u),S=Math.round(Math.max(1,o)*u);if(f<=1||S<=1)return!1;if(!r.current&&d){r.current=new(m(w))(d);try{r.current&&r.current.canvas&&r.current.canvas.setAttribute("data-testid","phaser-canvas")}catch{}console.debug("[PhaserCanvas] Game created with",f,S)}return!0}catch(e){return console.error("[PhaserCanvas] Failed to create Phaser.Game",e),!1}};function m(e){try{const o=require("phaser");return function(u){return new o.Game({...e,scene:[u]})}(d)}catch(o){throw o}}if(i){if(!y()){const a=setInterval(()=>{y()&&clearInterval(a)},50)}try{console.debug("[PhaserCanvas] Game created",!!r.current)}catch{}try{if(typeof window<"u"&&window.__PHASER_DEBUG__){try{window.getPhaserGame=()=>r.current}catch{}try{console.debug("[PhaserCanvas] window.getPhaserGame attached")}catch{}if(s.current){try{s.current.getPhaserGame=()=>r.current}catch{}try{console.debug("[PhaserCanvas] container.getPhaserGame attached")}catch{}}}}catch{}let e=r.current.scene.getScene("SnakeScene")||r.current.scene.getScenes&&r.current.scene.getScenes()[0],o=0;const u=[],f=[],S=[],C=a=>{if(a&&a.events){a.events.on("update",c=>{_.getState().setScore(c.score||0)}),a.events.on("gameOver",c=>{_.getState().setRunning(!1)}),a.events.on("ateFood",c=>{_.getState().setScore(c)});try{const c=h=>{a&&typeof a.processSimulatedSwipe=="function"&&a.processSimulatedSwipe(h.detail)};if(typeof window<"u"){window.addEventListener("snake-simulate-swipe",c);try{console.debug("[PhaserCanvas] attached snake-simulate-swipe listener")}catch{}}a.__onSimSwipe=c}catch(c){try{console.error("[PhaserCanvas] failed to attach onSimSwipe",c)}catch{}}return!0}return!1};if(!e||!e.events){const a=setInterval(()=>{if(o++,e=r.current.scene.getScene("SnakeScene")||r.current.scene.getScenes&&r.current.scene.getScenes()[0],(C(e)||o>20)&&(clearInterval(a),e)){try{console.debug("[PhaserCanvas] Processing queued events",u.length,f.length)}catch{}u.forEach(c=>{const{action:h,value:j}=c||{};h==="start"&&e.startGame(),h==="pause"&&e.pauseGame(),h==="resume"&&e.resumeGame(),h==="reset"&&e.resetGame(),h==="stop"&&e.stopGame(),h==="setBoardSize"&&e.setBoardSize(Number(j))}),f.forEach(c=>e.setDirection(c)),S.forEach(c=>{c&&typeof e.processSimulatedSwipe=="function"&&e.processSimulatedSwipe(c)}),S.length=0,u.length=0,f.length=0}},50)}else{C(e);try{console.debug("[PhaserCanvas] Scene immediately available, processing queued events",u.length,f.length)}catch{}u.forEach(a=>{const{action:c,value:h}=a||{};c==="start"&&e.startGame(),c==="pause"&&e.pauseGame(),c==="resume"&&e.resumeGame(),c==="reset"&&e.resetGame(),c==="stop"&&e.stopGame(),c==="setBoardSize"&&e.setBoardSize(Number(h))}),f.forEach(a=>e.setDirection(a)),S.forEach(a=>{a&&typeof e.processSimulatedSwipe=="function"&&e.processSimulatedSwipe(a)}),S.length=0,u.length=0,f.length=0}const M=a=>{if(e&&typeof e.setDirection=="function")e.setDirection(a.detail);else{try{console.debug("[PhaserCanvas] Queuing direction event",a.detail)}catch{}f.push(a.detail)}};window.addEventListener("snake-direction",M);const B=a=>{e&&typeof e.processSimulatedSwipe=="function"?e.processSimulatedSwipe(a.detail):S.push(a.detail)};window.addEventListener("snake-simulate-swipe",B);const A=a=>{const{action:c,value:h}=a.detail||{};if(!e){try{console.debug("[PhaserCanvas] Queuing control event",a.detail)}catch{}u.push(a.detail);return}switch(c){case"start":e.startGame();break;case"pause":e.pauseGame();break;case"resume":e.resumeGame();break;case"reset":e.resetGame();break;case"stop":e.stopGame();break;case"setBoardSize":e.setBoardSize(Number(h));break}};window.addEventListener("snake-control",A)}const b=()=>{var u,f,S;if(!r.current||!s.current)return;const{width:e,height:o}=p();(u=r.current)!=null&&u.scale&&r.current.scale.resize(e,o),(S=(f=r.current)==null?void 0:f.events)==null||S.emit("resize",{width:e,height:o})},v=new ResizeObserver(b);return s.current&&v.observe(s.current),()=>{if(i=!1,r.current){try{r.current.destroy(!0)}catch{}r.current=null}window.removeEventListener("snake-direction",onDir),window.removeEventListener("snake-simulate-swipe",onSim);try{if(r.current&&r.current.scene){const e=r.current.scene.getScene("SnakeScene")||r.current.scene.getScenes&&r.current.scene.getScenes()[0];e&&e.__onSimSwipe&&(window.removeEventListener("snake-simulate-swipe",e.__onSimSwipe),delete e.__onSimSwipe)}}catch{}window.removeEventListener("snake-control",onCtl),v.disconnect();try{s.current&&s.current.getPhaserGame&&delete s.current.getPhaserGame}catch{}try{window&&window.getPhaserGame&&delete window.getPhaserGame}catch{}}},[]),l.jsx("div",{ref:s,style:{width:t,height:n},className:"phaser-container"})},ve=pe,x=(t,n)=>{if(!(typeof window>"u"))try{window.dispatchEvent(new CustomEvent("snake-control",{detail:{action:t,value:n}}))}catch{}};function ge(){const[t,n]=E.useState(!1),[s,r]=E.useState(20),i=()=>{x("start"),n(!0)},d=()=>{x("pause"),n(!1)},g=()=>{x("reset"),n(!1)},p=w=>{r(w),x("setBoardSize",w)};return E.useEffect(()=>()=>{x("stop")},[]),l.jsxs("main",{className:"max-w-4xl mx-auto px-4 py-12",children:[l.jsx($,{title:"Snake",description:"A small, mobile-friendly Snake game built with Phaser."}),l.jsx(F,{title:"Snake Game",children:l.jsx("p",{className:"text-gray-300",children:"Play a short, focus-friendly Snake game. Use on-screen controls or your keyboard."})}),l.jsx("section",{className:"py-6",children:l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[l.jsx("div",{className:"bg-[#0b1220] p-6 rounded-xl border border-white/6",children:l.jsxs("div",{className:"flex flex-col gap-3",children:[l.jsx("div",{className:"text-gray-300",children:"Board Size"}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{className:"btn",onClick:()=>p(16),children:"Small"}),l.jsx("button",{className:"btn",onClick:()=>p(20),children:"Medium"}),l.jsx("button",{className:"btn",onClick:()=>p(28),children:"Large"})]}),l.jsxs("div",{className:"flex gap-2 mt-4",children:[t?l.jsx("button",{className:"btn",onClick:d,children:"Pause"}):l.jsx("button",{className:"btn btn-primary",onClick:i,children:"Start"}),l.jsx("button",{className:"btn",onClick:g,children:"Reset"})]})]})}),l.jsx("div",{className:"lg:col-span-2 bg-[#0b1220] p-6 rounded-xl border border-white/6",children:l.jsx("div",{className:"h-[480px]",children:l.jsx(ve,{width:"100%",height:"100%"})})})]})})]})}const ye=Object.freeze(Object.defineProperty({__proto__:null,default:ge},Symbol.toStringTag,{value:"Module"}));export{ye as S,_ as u};
